import{i as y,aa as _,$ as w,r as i,a as h,j as $,L as x,M as T,O as P,a7 as s,P as b,Q as j,a6 as q}from"./index.4e7eb3d4.js";import{u as Q,Q as S}from"./QPage.a4c0f7f3.js";import{d,a as B,r as D}from"./relativeTime.8a6da4df.js";import"./axios.704d01ad.js";import"./notify.6ea8d133.js";const I={class:"column items-center"},z=Object.assign({name:"ActivitiesPage"},{__name:"scan.page",setup(M){d.extend(B),d.extend(D);const n=Q(),v=y("notify"),c=_(),f=w(),r=i(c.params.id),l=i(c.query.type||"browser"),g={nfc:"nfc",qr:"qr_code",app:"app",browser:"tab"},e=h(()=>n.activities.find(t=>t.id==r.value)),u=i("");return $(async()=>{const t=Date.now(),a=2e3,p=e.value.occurrences.length>0&&!e.value.occurrences[e.value.occurrences.length-1].end;u.value=`${p?"Stopping":"Starting"} ${e.value.title}...`,await Promise.all([n.scan(r.value,l.value),new Promise(o=>setTimeout(o,a))]);const m=Date.now()-t;m<a&&await new Promise(o=>setTimeout(o,a-m)),v(`${e.value.title} ${p?"stopped":"started"}!`,{actions:[{label:"Undo",color:"white",handler:()=>{n.unscan(e.value.id)}}]}),f.push("/activities")}),(t,a)=>(x(),T(S,{class:"flex flex-center"},{default:P(()=>[s("div",I,[s("div",null,[b(j,{name:g[l.value],size:"104px",class:"q-pa-lg",color:"primary"},null,8,["name"])]),s("div",null,[s("h4",null,q(u.value),1)])])]),_:1}))}});export{z as default};
